<!DOCTYPE html>
<html>
<head>
    <meta charset = "UTF-8">
    <title>Discover</title>
    <script src = "maps_key.js"></script>
    <script id = "maps-api" async defer></script>
    <link rel = "stylesheet" href = "style.css">
</head>
<body onload = "setApiKeyAndMapsCallback()">
    <header> 
        <ul>
            <li><a href = "index.html">Home</a></li>
            <li><a href = "discover.html">Discover</a></li>
            <li><a href = "createPlaceGuide.html">Create PlaceGuide</a></li>
        </ul>
    </header>

    <input id = "search-box" type = "text" placeholder = "Search for a new place!"/>
    <div id = "map"></div>

    <script src = "maps_geolocation.js"></script>
    <script src = "maps_searchbox.js"></script>
    <script src = "maps_place.js"></script>
    <script src = "maps_show_places.js"></script>
    <script src = "maps_choose_place_byclick.js"></script>
    <script src = "maps_geocoding.js"></script>
    <script src="https://unpkg.com/@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"></script>
    <script> 
        /** This function initialises the map and adds some functionalities to it:
        * {@code addGoToMyLocationControl} allows the user to center the map
        * at their location by clicking a button.
        * {@code addEnableGeolocationControl} allows the user to turn on/off
        * the geolocation feature, which displays the user's current location continuously.
        * {@code initAutocomplete} sets up a search-box with auto-suggestions feature,
        * so that the user can search for a specific place. When a search query is submitted,
        * the map is centered at the requested place and a marker is displayed for it.
        */
        function createMap() {
            var myMapOptions = {
                zoom: 2,
                center: new google.maps.LatLng(0, 0),
                mapTypeId: 'roadmap',
            };
            const map = new google.maps.Map(
                document.getElementById('map'), myMapOptions);

            // Geolocation functionality
            var geolocator = new Geolocator(map);
            geolocator.init();

            var searchResult = new Place(0, 0, "Picked Location", null, PlaceType.SEARCH_RESULT, true);
            searchResult.draggable = true;
            searchResult.map = map;

            var searchBox = new SearchBox(map, searchResult, "search-box");
            searchBox.init();

            var userId = "test";
            displayPlaceGuidesOfUser(map, userId);
            enableChoosingPlaceByClick(map, searchResult);
        }
    </script>
</body>
</html>